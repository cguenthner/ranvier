<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>ranvier.core documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Ranvier</span> <span class="project-version">0.1.1</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1 current"><a href="ranvier.core.html"><div class="inner"><span>ranvier.core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="ranvier.core.html#var-abs"><div class="inner"><span>abs</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-acos"><div class="inner"><span>acos</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-add"><div class="inner"><span>add</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-asin"><div class="inner"><span>asin</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-assoc-iteration-data"><div class="inner"><span>assoc-iteration-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-assoc-node-data"><div class="inner"><span>assoc-node-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-atan"><div class="inner"><span>atan</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-backward"><div class="inner"><span>backward</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-const"><div class="inner"><span>const</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-construct-operand"><div class="inner"><span>construct-operand</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-cos"><div class="inner"><span>cos</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-cosh"><div class="inner"><span>cosh</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-defop"><div class="inner"><span>defop</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-defop-"><div class="inner"><span>defop-</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-dissoc-iteration-data"><div class="inner"><span>dissoc-iteration-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-div"><div class="inner"><span>div</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-element-count"><div class="inner"><span>element-count</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-emax"><div class="inner"><span>emax</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-emin"><div class="inner"><span>emin</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-eq"><div class="inner"><span>eq</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-esum"><div class="inner"><span>esum</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-evaluate"><div class="inner"><span>evaluate</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-exp"><div class="inner"><span>exp</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-filter-graph-nodes"><div class="inner"><span>filter-graph-nodes</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-fork"><div class="inner"><span>fork</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-forward"><div class="inner"><span>forward</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-G"><div class="inner"><span>G</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-ge"><div class="inner"><span>ge</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-all-graph-input-names"><div class="inner"><span>get-all-graph-input-names</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-all-graph-inputs"><div class="inner"><span>get-all-graph-inputs</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-all-graph-nodes"><div class="inner"><span>get-all-graph-nodes</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-calling-line-number"><div class="inner"><span>get-calling-line-number</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-datapoint-info"><div class="inner"><span>get-datapoint-info</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-datapoint-label"><div class="inner"><span>get-datapoint-label</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-datapoint-type"><div class="inner"><span>get-datapoint-type</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-datapoint-value"><div class="inner"><span>get-datapoint-value</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-gradients"><div class="inner"><span>get-gradients</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-iteration-data"><div class="inner"><span>get-iteration-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-backward-fns"><div class="inner"><span>get-node-backward-fns</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-data"><div class="inner"><span>get-node-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-forward-fn"><div class="inner"><span>get-node-forward-fn</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-initializer"><div class="inner"><span>get-node-initializer</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-name"><div class="inner"><span>get-node-name</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-op"><div class="inner"><span>get-node-op</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-operands"><div class="inner"><span>get-node-operands</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-type"><div class="inner"><span>get-node-type</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-node-value"><div class="inner"><span>get-node-value</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-optimized-graph"><div class="inner"><span>get-optimized-graph</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-optimized-inputs"><div class="inner"><span>get-optimized-inputs</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-optimized-params"><div class="inner"><span>get-optimized-params</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-optimized-state"><div class="inner"><span>get-optimized-state</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-private-nodes"><div class="inner"><span>get-private-nodes</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-get-upstream-nodes"><div class="inner"><span>get-upstream-nodes</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-gradient-descent-optimizer"><div class="inner"><span>gradient-descent-optimizer</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-gt"><div class="inner"><span>gt</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-input"><div class="inner"><span>input</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-is-const.3F"><div class="inner"><span>is-const?</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-is-datapoint.3F"><div class="inner"><span>is-datapoint?</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-is-input.3F"><div class="inner"><span>is-input?</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-is-op.3F"><div class="inner"><span>is-op?</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-join-along"><div class="inner"><span>join-along</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-le"><div class="inner"><span>le</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-log"><div class="inner"><span>log</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-lt"><div class="inner"><span>lt</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-datapoint"><div class="inner"><span>make-datapoint</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-node"><div class="inner"><span>make-node</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-optimizer-result"><div class="inner"><span>make-optimizer-result</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-print-logger"><div class="inner"><span>make-print-logger</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-shape"><div class="inner"><span>make-shape</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-make-value-reporter"><div class="inner"><span>make-value-reporter</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-max"><div class="inner"><span>max</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-max-along"><div class="inner"><span>max-along</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-max-mask"><div class="inner"><span>max-mask</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-min"><div class="inner"><span>min</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-min-along"><div class="inner"><span>min-along</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-min-mask"><div class="inner"><span>min-mask</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-mmul"><div class="inner"><span>mmul</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-mul"><div class="inner"><span>mul</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-named"><div class="inner"><span>named</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-ne"><div class="inner"><span>ne</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-negate"><div class="inner"><span>negate</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-node-types"><div class="inner"><span>node-types</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-node.3F"><div class="inner"><span>node?</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-ones"><div class="inner"><span>ones</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-optimize"><div class="inner"><span>optimize</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-optimize-async"><div class="inner"><span>optimize-async</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-pad"><div class="inner"><span>pad</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-pad-with"><div class="inner"><span>pad-with</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-partition-along"><div class="inner"><span>partition-along</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-partition-along-op"><div class="inner"><span>partition-along-op</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-pow"><div class="inner"><span>pow</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-random-normal"><div class="inner"><span>random-normal</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-random-uniform"><div class="inner"><span>random-uniform</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-report"><div class="inner"><span>report</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-reset-optimizer-reporting"><div class="inner"><span>reset-optimizer-reporting</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-reshape"><div class="inner"><span>reshape</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-select-range"><div class="inner"><span>select-range</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-set-rng-seed.21"><div class="inner"><span>set-rng-seed!</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-shape"><div class="inner"><span>shape</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-shift"><div class="inner"><span>shift</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-simple-optimize"><div class="inner"><span>simple-optimize</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-sin"><div class="inner"><span>sin</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-sinh"><div class="inner"><span>sinh</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-size"><div class="inner"><span>size</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-slices"><div class="inner"><span>slices</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-slices-op"><div class="inner"><span>slices-op</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-sub"><div class="inner"><span>sub</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-sum-along"><div class="inner"><span>sum-along</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tan"><div class="inner"><span>tan</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tanh"><div class="inner"><span>tanh</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tensor-and"><div class="inner"><span>tensor-and</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tensor-not"><div class="inner"><span>tensor-not</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tensor-or"><div class="inner"><span>tensor-or</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tensure-max-mask"><div class="inner"><span>tensure-max-mask</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-tensure-min-mask"><div class="inner"><span>tensure-min-mask</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-transpose"><div class="inner"><span>transpose</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-update-iteration-data"><div class="inner"><span>update-iteration-data</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-update-node"><div class="inner"><span>update-node</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-validate-optimizer-result"><div class="inner"><span>validate-optimizer-result</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-wrap-optimizer-for-reporting"><div class="inner"><span>wrap-optimizer-for-reporting</span></div></a></li><li class="depth-1"><a href="ranvier.core.html#var-zeros"><div class="inner"><span>zeros</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">ranvier.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-abs"><h3>abs</h3><div class="usage"><code>(abs a)</code></div><div class="doc"><div class="markdown"><p>|a|</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L594">view source</a></div></div><div class="public anchor" id="var-acos"><h3>acos</h3><div class="usage"><code>(acos n)</code></div><div class="doc"><div class="markdown"><p>cos-1(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1199">view source</a></div></div><div class="public anchor" id="var-add"><h3>add</h3><div class="usage"><code>(add &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Addition of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L487">view source</a></div></div><div class="public anchor" id="var-asin"><h3>asin</h3><div class="usage"><code>(asin n)</code></div><div class="doc"><div class="markdown"><p>sin-1(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1205">view source</a></div></div><div class="public anchor" id="var-assoc-iteration-data"><h3>assoc-iteration-data</h3><div class="usage"><code>(assoc-iteration-data optimizer-result k v)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, assoc’s a new key-value (<code>k</code>-<code>v</code>) pair into the iteration-data map.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2341">view source</a></div></div><div class="public anchor" id="var-assoc-node-data"><h3>assoc-node-data</h3><div class="usage"><code>(assoc-node-data node k v)</code></div><div class="doc"><div class="markdown"><p>Assoc’s key/value pair <code>k</code>/<code>v</code> into <code>node</code>’s data map.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L187">view source</a></div></div><div class="public anchor" id="var-atan"><h3>atan</h3><div class="usage"><code>(atan n)</code></div><div class="doc"><div class="markdown"><p>tan-1(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1211">view source</a></div></div><div class="public anchor" id="var-backward"><h3>backward</h3><div class="usage"><code>(backward node)</code><code>(backward node values)</code><code>(backward node values inputs)</code><code>(backward node values inputs grad)</code><code>(backward node values inputs grad options)</code></div><div class="doc"><div class="markdown"><p>Given:</p>
<ul>
  <li><code>node</code> - a computation graph node</li>
  <li><code>values</code> - a map of input values (variable name -&gt; tensor)</li>
  <li><code>inputs</code> - a seq of names of inputs for which to return gradients; if <code>nil</code>, all gradients are returned</li>
  <li><code>grad</code> - the propagated gradient tensor</li>
  <li><code>options</code> - a map that can contain the following keys:
    <ul>
      <li><code>:stop-at</code> - a seq of nodes at which to stop backpropagation. This can be useful (e.g. during  backprop through recurrent networks) for accumulating the gradient of a node outside of <code>backward</code>  before backpropagating through it.</li>
      <li><code>:return-all</code> - boolean indicating what gradient values to return for nodes whose names are in  <code>inputs</code> but that weren’t encountered during backpropagation. If <code>true</code>, a zero gradient is returned;  otherwise, the node name is omitted from the returned map.</li>
      <li><code>:recurred-grads</code> - a map of node name to gradients being propagated through a recurrent network.</li>
    </ul>
  </li>
</ul>
<p>this returns a map of gradients for each input. <code>values</code> may be omitted only if the graph has no variables. If <code>grad</code> is omitted, a tensor of the same shape as the node value filled with all 1’s will be assumed.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1799">view source</a></div></div><div class="public anchor" id="var-const"><h3>const</h3><div class="usage"><code>(const val)</code><code>(const val name)</code></div><div class="doc"><div class="markdown"><p>Returns a new constant node with value <code>val</code> and (optionally) name <code>name</code> (autogenerated if not provided).</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L255">view source</a></div></div><div class="public anchor" id="var-construct-operand"><h3>construct-operand</h3><div class="usage"><code>(construct-operand operand)</code><code>(construct-operand operand nd?)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L32">view source</a></div></div><div class="public anchor" id="var-cos"><h3>cos</h3><div class="usage"><code>(cos n)</code></div><div class="doc"><div class="markdown"><p>cos(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1181">view source</a></div></div><div class="public anchor" id="var-cosh"><h3>cosh</h3><div class="usage"><code>(cosh n)</code></div><div class="doc"><div class="markdown"><p>cosh(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1217">view source</a></div></div><div class="public anchor" id="var-defop"><h3>defop</h3><h4 class="type">macro</h4><div class="usage"><code>(defop name &amp; args)</code></div><div class="doc"><div class="markdown"><p>Define an operation. Example usage:</p>
<pre><code>  (defop increment  ; Op name
    "Given scalar `n`, returns `n + 1`."  ; Optional docstring
    [n]  ; Operand list
    :v (+ n 1)  ; Name and expression for the operation result (v = n + 1)
    :dn dv  ; Name and expression for the gradient of the operand; dv is the gradient of v
   )
</code></pre>
<p>The first element of the body (e.g. <code>:v</code>) is a keyword name for the value returned by the following expression (e.g. <code>(+ n 1)</code>). This is followed by, alternately, the keyword names (e.g. <code>:dn</code>) and expressions (e.g. <code>dv</code>) for the gradients of each operand. The derivative name must match the name of the argument in the argument list, prefixed by a <code>d</code>. A symbol for the backpropagated result gradient (the name of the result prefixed with <code>d</code>–e.g. <code>dv</code>) is available in the context of the derivative expression.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L365">view source</a></div></div><div class="public anchor" id="var-defop-"><h3>defop-</h3><h4 class="type">macro</h4><div class="usage"><code>(defop- name &amp; args)</code></div><div class="doc"><div class="markdown"><p>Like <code>defop</code> but defines a private operation (available only in the namespace where it’s defined).</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L419">view source</a></div></div><div class="public anchor" id="var-dissoc-iteration-data"><h3>dissoc-iteration-data</h3><div class="usage"><code>(dissoc-iteration-data optimizer-result k)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, dissoc’s <code>k</code> from its iteration-data map and returns the resulting new optimizer-result.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2347">view source</a></div></div><div class="public anchor" id="var-div"><h3>div</h3><div class="usage"><code>(div first-operand &amp; rest-operands)</code></div><div class="doc"><div class="markdown"><p>Division of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L539">view source</a></div></div><div class="public anchor" id="var-element-count"><h3>element-count</h3><div class="usage"><code>(element-count nd)</code></div><div class="doc"><div class="markdown"><p>Returns the number of scalar elements in <code>nd</code> as a Tensure object.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L784">view source</a></div></div><div class="public anchor" id="var-emax"><h3>emax</h3><div class="usage"><code>(emax a)</code></div><div class="doc"><div class="markdown"><p>Returns the maximum element in <code>a</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L657">view source</a></div></div><div class="public anchor" id="var-emin"><h3>emin</h3><div class="usage"><code>(emin a)</code></div><div class="doc"><div class="markdown"><p>Returns the minimum element in <code>a</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L663">view source</a></div></div><div class="public anchor" id="var-eq"><h3>eq</h3><div class="usage"><code>(eq &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise logical equality for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1084">view source</a></div></div><div class="public anchor" id="var-esum"><h3>esum</h3><div class="usage"><code>(esum a)</code></div><div class="doc"><div class="markdown"><p>Returns the scalar sum of all the elements of <code>a</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L651">view source</a></div></div><div class="public anchor" id="var-evaluate"><h3>evaluate</h3><div class="usage"><code>(evaluate node)</code><code>(evaluate node input-map)</code></div><div class="doc"><div class="markdown"><p>Given a computation graph <code>node</code> and a map of input variable names to their tensor values, runs the computation and returns the value of the final result.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1885">view source</a></div></div><div class="public anchor" id="var-exp"><h3>exp</h3><div class="usage"><code>(exp a)</code></div><div class="doc"><div class="markdown"><p>e ^ a</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L600">view source</a></div></div><div class="public anchor" id="var-filter-graph-nodes"><h3>filter-graph-nodes</h3><div class="usage"><code>(filter-graph-nodes f node)</code></div><div class="doc"><div class="markdown"><p>Given a root <code>node</code> of a computation graph, returns a seq of nodes in that computation graph for which <code>(f node)</code> is truthy.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L206">view source</a></div></div><div class="public anchor" id="var-fork"><h3>fork</h3><div class="usage"><code>(fork input-bindings recur-bindings output-node recur-branches)</code><code>(fork input-bindings recur-bindings output-node recur-branches options)</code></div><div class="doc"><div class="markdown"><p>Given:</p>
<ul>
  <li><code>input-bindings</code> - a vector with alternating input and seq-valued nodes of all the same length, e.g. <code>[:input-a (slices :a) :input-b (slices :b)... ]</code>.</li>
  <li><code>recur-bindings</code> - a vector with alternating input and initialization value nodes, e.g. <code>[:recur-target-a :initialization-value :recur-target-b :initialization-value-b ...]</code></li>
  <li><code>output-node</code> - a graph node</li>
  <li><code>recur-branches</code> - a seq of nodes equal in number to the number of recurrence targets specified in <code>recur-bindings</code></li>
  <li><code>options</code> - a map of optional key/value pairs:
    <ul>
      <li><code>output-time-axis</code> (deafult 0) - axis along which to concatenate output values (see below).</li>
    </ul>
  </li>
</ul>
<p>this evaluates <code>output-node</code> exactly n times, where n is the count of elements in the seqs in <code>input-bindings</code>. The value of the <code>fork</code> node will be a tensor produced by concatenating together the n values of <code>output-node</code> along <code>:output-time-axis</code>. The nth output value is the result of evaluating <code>output-node</code> in a context where each input node in <code>input-bindings</code> is bound to the nth value in its corresponding seq and each input node in <code>recur-bindings</code> is bound to the value of the corresponding node in <code>recur-branches</code> on the (n-1)th iteration, or to the value of the corresponding ndoe in <code>recur-bindings</code> when n=0. None of the input nodes used for bindings may be used elsewhere in the graph outside this <code>fork</code> node.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1575">view source</a></div></div><div class="public anchor" id="var-forward"><h3>forward</h3><div class="usage"><code>(forward node)</code><code>(forward node input-map)</code></div><div class="doc"><div class="markdown"><p>Given a computation graph <code>node</code> and a map of input variable names to their tensor values, runs the computation and returns a map of node to value.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1747">view source</a></div></div><div class="public anchor" id="var-G"><h3>G</h3><h4 class="type">macro</h4><div class="usage"><code>(G body)</code></div><div class="doc"><div class="markdown"><p>Receives a single form and returns a computation graph. This macro provides two advantages over constructing graphs by just calling ops directly:</p>
<ol>
  <li>Any symbol in <code>body</code> that matches the alias of an op will resolve to that op. For instance, inside of  <code>G</code>, <code>*</code> will resolve to the ranvier <code>mul</code> op, rather than to <code>clojure.core/*</code>.</li>
  <li>The nodes returned by ops in the body of <code>G</code> receive additional metadata that can greatly facilitate  debugging. Runtime exceptions from graphs constructed with <code>G</code> will in many cases contain information  about where the node was constructed; such information is not available in exceptions arising from  evaluation of graph nodes constructed outside of <code>G</code>.</li>
</ol></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1983">view source</a></div></div><div class="public anchor" id="var-ge"><h3>ge</h3><div class="usage"><code>(ge &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise &gt;= for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1134">view source</a></div></div><div class="public anchor" id="var-get-all-graph-input-names"><h3>get-all-graph-input-names</h3><div class="usage"><code>(get-all-graph-input-names graph)</code></div><div class="doc"><div class="markdown"><p>Returns a seq of (keyword) names for all of <code>graph</code>s input nodes, given the root node of the graph.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L221">view source</a></div></div><div class="public anchor" id="var-get-all-graph-inputs"><h3>get-all-graph-inputs</h3><div class="usage"><code>(get-all-graph-inputs graph)</code></div><div class="doc"><div class="markdown"><p>Given a computation <code>graph</code> (the root node of the graph), returns a seq of all the input nodes.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L216">view source</a></div></div><div class="public anchor" id="var-get-all-graph-nodes"><h3>get-all-graph-nodes</h3><div class="usage"><code>(get-all-graph-nodes graph)</code></div><div class="doc"><div class="markdown"><p>Returns a seq of all nodes in the provided computation graph.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L193">view source</a></div></div><div class="public anchor" id="var-get-calling-line-number"><h3>get-calling-line-number</h3><div class="usage"><code>(get-calling-line-number callstack)</code></div><div class="doc"><div class="markdown"><p>Given a callstack (seq of <code>StackTraceElements</code>) leading to creation of a node via an op in a <code>G</code> form (see <code>G</code> below), returns (if possible) a proposed line number of the original op call. This is fragile. It depends on implementation details of Clojure as well as ranvier and is thus liable to break in the future. However, having these line numbers can greatly simplify debugging.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1971">view source</a></div></div><div class="public anchor" id="var-get-datapoint-info"><h3>get-datapoint-info</h3><div class="usage"><code>(get-datapoint-info datapoint)</code></div><div class="doc"><div class="markdown"><p>Returns the info map of a datapoint.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2147">view source</a></div></div><div class="public anchor" id="var-get-datapoint-label"><h3>get-datapoint-label</h3><div class="usage"><code>(get-datapoint-label datapoint)</code></div><div class="doc"><div class="markdown"><p>Returns the label for a datapoint.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2137">view source</a></div></div><div class="public anchor" id="var-get-datapoint-type"><h3>get-datapoint-type</h3><div class="usage"><code>(get-datapoint-type datapoint)</code></div><div class="doc"><div class="markdown"><p>Returns the type of a datapoint.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2142">view source</a></div></div><div class="public anchor" id="var-get-datapoint-value"><h3>get-datapoint-value</h3><div class="usage"><code>(get-datapoint-value datapoint)</code></div><div class="doc"><div class="markdown"><p>Returns the value of a datapoint.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2132">view source</a></div></div><div class="public anchor" id="var-get-gradients"><h3>get-gradients</h3><div class="usage"><code>(get-gradients node)</code><code>(get-gradients node input-map)</code><code>(get-gradients node input-map options)</code></div><div class="doc"><div class="markdown"><p>Given a computation graph <code>node</code> and a map of input variable names to their tensor values, runs forward and back propagation and returns a map of all gradients.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1894">view source</a></div></div><div class="public anchor" id="var-get-iteration-data"><h3>get-iteration-data</h3><div class="usage"><code>(get-iteration-data optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, returns <code>iteration-data</code>, a map of arbitrary key/value pairs determined by the <code>optimizer</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2334">view source</a></div></div><div class="public anchor" id="var-get-node-backward-fns"><h3>get-node-backward-fns</h3><div class="usage"><code>(get-node-backward-fns node)</code></div><div class="doc"><div class="markdown"><p>Returns the backpropagation function of an op <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L153">view source</a></div></div><div class="public anchor" id="var-get-node-data"><h3>get-node-data</h3><div class="usage"><code>(get-node-data node)</code></div><div class="doc"><div class="markdown"><p>Returns a map of <code>data</code> associated with <code>node</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L182">view source</a></div></div><div class="public anchor" id="var-get-node-forward-fn"><h3>get-node-forward-fn</h3><div class="usage"><code>(get-node-forward-fn node)</code></div><div class="doc"><div class="markdown"><p>Returns the forward propagation function of an op <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L148">view source</a></div></div><div class="public anchor" id="var-get-node-initializer"><h3>get-node-initializer</h3><div class="usage"><code>(get-node-initializer node)</code></div><div class="doc"><div class="markdown"><p>Returns the initializer function of a <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L158">view source</a></div></div><div class="public anchor" id="var-get-node-name"><h3>get-node-name</h3><div class="usage"><code>(get-node-name node)</code></div><div class="doc"><div class="markdown"><p>Returns the name of a <code>node</code> (a keyword).</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L128">view source</a></div></div><div class="public anchor" id="var-get-node-op"><h3>get-node-op</h3><div class="usage"><code>(get-node-op node)</code></div><div class="doc"><div class="markdown"><p>Returns the name of the operation for an op <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L138">view source</a></div></div><div class="public anchor" id="var-get-node-operands"><h3>get-node-operands</h3><div class="usage"><code>(get-node-operands node)</code></div><div class="doc"><div class="markdown"><p>Returns a seq of operand nodes for an op <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L143">view source</a></div></div><div class="public anchor" id="var-get-node-type"><h3>get-node-type</h3><div class="usage"><code>(get-node-type node)</code></div><div class="doc"><div class="markdown"><p>Returns the type of a <code>node</code> (<code>:const</code>, <code>:input</code>, or <code>:op</code>).</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L123">view source</a></div></div><div class="public anchor" id="var-get-node-value"><h3>get-node-value</h3><div class="usage"><code>(get-node-value node)</code></div><div class="doc"><div class="markdown"><p>Returns the value of a constant <code>node</code>, or else <code>nil</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L133">view source</a></div></div><div class="public anchor" id="var-get-optimized-graph"><h3>get-optimized-graph</h3><div class="usage"><code>(get-optimized-graph optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, returns the computation graph for the corresponding optimization problem.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2328">view source</a></div></div><div class="public anchor" id="var-get-optimized-inputs"><h3>get-optimized-inputs</h3><div class="usage"><code>(get-optimized-inputs optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, returns a map of input names to values.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2316">view source</a></div></div><div class="public anchor" id="var-get-optimized-params"><h3>get-optimized-params</h3><div class="usage"><code>(get-optimized-params optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, returns a map of parameter names to values.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2310">view source</a></div></div><div class="public anchor" id="var-get-optimized-state"><h3>get-optimized-state</h3><div class="usage"><code>(get-optimized-state optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code>, returns a map of state input names to values.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2322">view source</a></div></div><div class="public anchor" id="var-get-private-nodes"><h3>get-private-nodes</h3><div class="usage"><code>(get-private-nodes node)</code></div><div class="doc"><div class="markdown"><p>Returns a seq of nodes that are 1) upstream of <code>node</code> and 2) ‘private’ (i.e. that cannot be used in the graph outside of the subranch upstream of <code>node</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L169">view source</a></div></div><div class="public anchor" id="var-get-upstream-nodes"><h3>get-upstream-nodes</h3><div class="usage"><code>(get-upstream-nodes node)</code></div><div class="doc"><div class="markdown"><p>Returns a seq all ‘upstream’ nodes of the provided <code>node</code>, i.e. all those nodes that are operands, operands of operands, etc. The term ‘upstream’ is from the perpsective of forward propagation.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L163">view source</a></div></div><div class="public anchor" id="var-gradient-descent-optimizer"><h3>gradient-descent-optimizer</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>An optimizer that minimizes the value produced by running the <code>graph</code> using stadnard gradient descent methods. <code>options</code> can include:</p>
<ul>
  <li><code>learning-rate</code> - gradient multipler to use for calculating updated parameter values (defaults to 0.001). Each iteration updates a given parameter X by step-size, where step-size[X] = dX * learning-rate and dX is the gradient of X. Thus, given that X[t] is the value of parameter X on iteration t, X[t+1] = X[t] - step-size * dX.</li>
  <li><code>report</code> - a seq of keys for reporting (see <code>wrap-optimizer-for-reqporting</code>).</li>
  <li><code>logger</code> - a logger for reporting</li>
  <li><code>iterations</code> - the target number of iterations (used only for reporitng purposes)</li>
  <li><code>batch-size</code> - positive integer indicating the size of a batch (defaults to 192 if <code>batch-inputs</code> is provided</li>
  <li><code>batch-inputs</code> - map of input name to axes to batch along. For instance, if input :x is a matrix with examples in columns and input :y is a vector of values for each example and you want to run a batch of examples on each iteration, <code>batch-inputs</code> should be {:x 1 :y 0}. (Defaults to batching along the 0th dimension if <code>batch-size</code> is provided.)</li>
  <li><code>friction</code> - ‘friction’ value used for smoothing gradients. If omitted, no smoothing is done, and step-size[X,t] = dX[t] * learning-rate for iteration t as described above. If specified, then step-size[X,t] = dXsmoothed[t] * learning-rate / (1 - friction ^ t), where dXsmoothed[t] is the expoentionally weighted moving average of dX over iterations 1…t.:
    <p>dXsmoothed[t] = dXsmoothed[t - 1] * friction + (1 - friction) * dX[t]</p>
    <p>(Recommended value: 0.9).</p>
  </li>
  <li><code>eps</code> - a small value used for numerical stability when using RMSProp. See below. (Defaults to 1e-8.)</li>
  <li><code>rms-friction</code> - ‘friction’ to use for RMSProp; if ommitted, RMSProp is not used. If included:
    <p>step-size[X,t] = learning-rate * dXsmoothed[t] / (sqrt(bias-corrected-ewma-squared-grads[X,t]) + eps)</p>
    <p>where:</p>
    <p>bias-corrected-ewma-squared-grads[X,t] = ewma-squared-grads[X,t] / (1 - rms-friction ^ t)</p>
    <p>and ewma-squared-grad[X,t] is the exponentially weighted moving average of the squared gradients over 1…t:</p>
    <p>ewma-squared-grads[X,t] = ewma-squared-grads[X, t - 1] * friction + dXsmoothed[t] ^ 2 * (1 - friction)</p>
    <p>(Recommended value: 0.999).</p>
  </li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2659">view source</a></div></div><div class="public anchor" id="var-gt"><h3>gt</h3><div class="usage"><code>(gt &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise &gt; for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1118">view source</a></div></div><div class="public anchor" id="var-input"><h3>input</h3><div class="usage"><code>(input name)</code><code>(input name initializer-is-nd-or-data)</code><code>(input name initializer-or-is-nd is-nd-or-data)</code><code>(input name initializer is-nd? data)</code></div><div class="doc"><div class="markdown"><p>Cosntructs an input node from:</p>
<ul>
  <li><code>name</code> (required) - keyword name for this node</li>
  <li><code>is-nd?</code> (optional, default <code>nil</code>) - boolean indicating if this input is a tensor. If <code>true</code>, values provided for this input (including numbers and vectors of vectors/numbers) will automatically be converted into tensors. If <code>false</code>, the input values will be unaltered. If <code>nil</code>, they will be converted into a tensor automatically if they are used in an op in the graph that expects a tensor; otherwise they’ll remain unaltered.</li>
  <li><code>initializer</code> (optional) - function that must receive a map of node names to values for nodes that have been evaluated thus far and that must return the initialized value for this node.</li>
  <li><code>data</code> (optional) - map of arbitrary key-value pairs to associate with this node.</li>
</ul>
<p>The arguments can be provided in any of the following combinations:  (input name)  (input name initializer)  (input name is-nd?)  (input name data)  (input name initializer is-nd?)  (input name initializer data)  (input name is-nd data)  (input name initiailizer is-nd? data)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L264">view source</a></div></div><div class="public anchor" id="var-is-const.3F"><h3>is-const?</h3><div class="usage"><code>(is-const? node)</code></div><div class="doc"><div class="markdown"><p>Returns true iff <code>node</code> is a constant node.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L108">view source</a></div></div><div class="public anchor" id="var-is-datapoint.3F"><h3>is-datapoint?</h3><div class="usage"><code>(is-datapoint? o)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> iff <code>o</code> is ranvier datapoint object.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2127">view source</a></div></div><div class="public anchor" id="var-is-input.3F"><h3>is-input?</h3><div class="usage"><code>(is-input? node)</code></div><div class="doc"><div class="markdown"><p>Returns true iff <code>node</code> is an input node.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L113">view source</a></div></div><div class="public anchor" id="var-is-op.3F"><h3>is-op?</h3><div class="usage"><code>(is-op? node)</code></div><div class="doc"><div class="markdown"><p>Returns true iff <code>node</code> is an operation node.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L118">view source</a></div></div><div class="public anchor" id="var-join-along"><h3>join-along</h3><div class="usage"><code>(join-along dim &amp; nds)</code></div><div class="doc"><div class="markdown"><p>Concatenates an arbitrary number of tensors in <code>nds</code> along <code>dim</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L852">view source</a></div></div><div class="public anchor" id="var-le"><h3>le</h3><div class="usage"><code>(le &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise &lt;= for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1166">view source</a></div></div><div class="public anchor" id="var-log"><h3>log</h3><div class="usage"><code>(log a)</code></div><div class="doc"><div class="markdown"><p>ln a (natural–base e–logarithm of a)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L606">view source</a></div></div><div class="public anchor" id="var-lt"><h3>lt</h3><div class="usage"><code>(lt &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise &lt; for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1150">view source</a></div></div><div class="public anchor" id="var-make-datapoint"><h3>make-datapoint</h3><div class="usage"><code>(make-datapoint value label type)</code><code>(make-datapoint value label type info)</code></div><div class="doc"><div class="markdown"><p>Constructs a datapoint given:</p>
<ul>
  <li><code>value</code> - The value of the datapoint (can be of arbitrary type or <code>nil</code>)</li>
  <li><code>type</code> - The type of the datapoint (must exist in the <code>datapoint-types</code> set immediately above</li>
  <li><code>label</code> - A string or keyword label for the datapoint</li>
  <li><code>info</code> - An optional map of arbitrary key:value pairs to associate with the datapoint. This can be used  downstream by loggers to, e.g., determine the format of the datapoint.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2109">view source</a></div></div><div class="public anchor" id="var-make-node"><h3>make-node</h3><div class="usage"><code>(make-node opts)</code></div><div class="doc"><div class="markdown"><p>Returns a new computation graph node. <code>opts</code> must contain:</p>
<ul>
  <li><code>:type</code> - the type of node (<code>:op</code>, <code>:const</code>, or <code>:input</code>)</li>
</ul>
<p>It may additionally contain:</p>
<ul>
  <li><code>:value</code> - the value of a <code>:const</code> node</li>
  <li><code>:name</code> - the keyword name of the node (autogenerated if not provided)</li>
  <li><code>:op</code> - keyword indicating the operation (for <code>:op</code> nodes)</li>
  <li><code>:operands</code> - vector of operand nodes</li>
  <li><code>forward-fn</code> - for <code>:op</code> nodes, a function <code>f</code> for which <code>(apply f operands)</code> returns the value of the node:</li>
  <li><code>backward-fns</code> - for <code>:op</code> nodes, a seq of functions <code>f1</code>, <code>f2</code>, <code>f3</code>, …, <code>fi</code> where <code>(apply fi dy v1 v2 v3 ...)</code> returns the gradient <code>dv1/d-out</code>, where <code>d-out</code> is the final output of the graph, <code>y</code> is the value of this node, <code>dy</code> is the gradient of this node (<code>dy/d-out</code>), and <code>v1</code>, <code>v2</code>, <code>v3</code>, …, <code>vi</code> are the values of the operands</li>
  <li><code>initializer</code> - for <code>:input</code> nodes, a function <code>f</code> for which <code>(f input-map)</code> returns the initial value of the node (on the first run of the graph if its value is not provided); <code>input-map</code> is a map of node names to values for nodes that have already been evaluated.</li>
  <li><code>:private-nodes</code> - a set of names of nodes that are private to a node’s subtree (i.e. that cannot appear in the graph outside the nodes opearnds)</li>
  <li><code>data</code> - an arbitrary map of additional data</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L50">view source</a></div></div><div class="public anchor" id="var-make-optimizer-result"><h3>make-optimizer-result</h3><div class="usage"><code>(make-optimizer-result updated-graph updated-input-map updated-param-map updated-state-map)</code><code>(make-optimizer-result updated-graph updated-input-map updated-param-map updated-state-map iteration-data)</code></div><div class="doc"><div class="markdown"><p>Constructs an <code>optimizer-result</code> from:</p>
<ul>
  <li><code>updated-graph</code> - a computation graph</li>
  <li><code>updated-input-map</code> - an updated map of input names to values</li>
  <li><code>updated-param-map</code> - an updated map of parameter names to values</li>
  <li><code>updated-state-map</code> - an updated map of state input names to values</li>
  <li><code>iteration-data</code> - a map of arbitrary key-value pairs that the optimizer can use to keep track of data from one iteration to the next.</li>
</ul>
<p>For typical optimization problems, the <code>param-map</code> will usually change from iteration to iteration, <code>state-map</code> may change from iteration to iteration, and the <code>input-map</code> may change only on the first iteration if some inputs are initialized at that time, and the <code>graph</code> itself will change only if it’s dynamic in such a way that running it can change its structure.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2280">view source</a></div></div><div class="public anchor" id="var-make-print-logger"><h3>make-print-logger</h3><div class="usage"><code>(make-print-logger &amp; opts)</code></div><div class="doc"><div class="markdown"><p>Returns a logger that prints reported datapoints to <em>out</em>. <code>opts</code> can include:</p>
<ul>
  <li><code>:space</code> - include a space after the printed value</li>
  <li><code>:newline</code> - include a newline after the printed value</li>
</ul>
<p>The logger flushes on :newline.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2192">view source</a></div></div><div class="public anchor" id="var-make-shape"><h3>make-shape</h3><div class="usage"><code>(make-shape &amp; sizes)</code></div><div class="doc"><div class="markdown"><p>An op that, given any number of dimension <code>sizes</code> (either as scalar tensors or as numbers), returns a tensor shape (a vector of natural numbers).</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L927">view source</a></div></div><div class="public anchor" id="var-make-value-reporter"><h3>make-value-reporter</h3><div class="usage"><code>(make-value-reporter)</code><code>(make-value-reporter label)</code><code>(make-value-reporter label decimal-places)</code></div><div class="doc"><div class="markdown"><p>Returns a reporter function for tensor or numeric values. Optional <code>decimal-places</code> (default 4) can be provided and may be used by the logger for formatting.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2229">view source</a></div></div><div class="public anchor" id="var-max"><h3>max</h3><div class="usage"><code>(max first-operand &amp; rest-operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise maximum of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L623">view source</a></div></div><div class="public anchor" id="var-max-along"><h3>max-along</h3><div class="usage"><code>(max-along nd)</code><code>(max-along nd {:keys [axis collapse], :as options})</code></div><div class="doc"><div class="markdown"><p>Returns the maximum across some dimensions of the input tensor. <code>options</code> can include:</p>
<ul>
  <li><code>:axis</code> - an integer or a vector of integers of the axes to sum across</li>
  <li><code>:collapse</code> (optional, default true) - a boolean that if <code>true</code> indicates the summed dimension should  be removed, and, if false, indicates it should be kept with a size of 1.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L732">view source</a></div></div><div class="public anchor" id="var-max-mask"><h3>max-mask</h3><div class="usage"><code>(max-mask nd axes)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of the same shape of <code>nd</code> where all elements that are the max along <code>axes</code> (a single axis or vector of axes) are 1 and the remaining elements are 0. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L720">view source</a></div></div><div class="public anchor" id="var-min"><h3>min</h3><div class="usage"><code>(min first-operand &amp; rest-operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise minimum of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L637">view source</a></div></div><div class="public anchor" id="var-min-along"><h3>min-along</h3><div class="usage"><code>(min-along nd)</code><code>(min-along nd {:keys [axis collapse], :as options})</code></div><div class="doc"><div class="markdown"><p>Returns the minimum across some dimensions of the input tensor. <code>options</code> can include:</p>
<ul>
  <li><code>:axis</code> - an integer or a vector of integers of the axes to sum across</li>
  <li><code>:collapse</code> (optional, default true) - a boolean that if <code>true</code> indicates the summed dimension should  be removed, and, if false, indicates it should be kept with a size of 1.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L766">view source</a></div></div><div class="public anchor" id="var-min-mask"><h3>min-mask</h3><div class="usage"><code>(min-mask nd axes)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of the same shape of <code>nd</code> where all elements that are the min along <code>axes</code> (a single axis or vector of axes) are 1 and the remaining elements are 0. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L754">view source</a></div></div><div class="public anchor" id="var-mmul"><h3>mmul</h3><div class="usage"><code>(mmul a b)</code></div><div class="doc"><div class="markdown"><p>Computes:</p>
<ul>
  <li>the inner product of <code>a</code> and <code>b</code> when <code>a</code> and <code>b</code> are matrices or vectors</li>
  <li>the inner product of the highest dimension of the tensor with the vector when one argument is a tensor and the other is a vector</li>
  <li>the tensor dot product of <code>a</code> and <code>b</code> when either <code>a</code> or <code>b</code> is a tensor and the other is a tensor or matrix</li>
  <li>element-wise product when <code>a</code> or <code>b</code> is a scalar</li>
</ul>
<p>When a and b are tensors of shape [a b c d e] and [f g h i j], then the product will be a tensor of shape [a b c d g e h i j] - i.e. the result is produced by multiplying every d x e matrix from <code>a</code> by every f x g matrix from <code>b</code> to get a * b * c * h * i * j d x g products.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L576">view source</a></div></div><div class="public anchor" id="var-mul"><h3>mul</h3><div class="usage"><code>(mul &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Multiplication of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L523">view source</a></div></div><div class="public anchor" id="var-named"><h3>named</h3><div class="usage"><code>(named new-name node)</code></div><div class="doc"><div class="markdown"><p>Creates a new node that’s identical to <code>node</code> but named <code>new-name</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L177">view source</a></div></div><div class="public anchor" id="var-ne"><h3>ne</h3><div class="usage"><code>(ne &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise logical inequality for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1096">view source</a></div></div><div class="public anchor" id="var-negate"><h3>negate</h3><div class="usage"><code>(negate a)</code></div><div class="doc"><div class="markdown"><p>-a</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L495">view source</a></div></div><div class="public anchor" id="var-node-types"><h3>node-types</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L21">view source</a></div></div><div class="public anchor" id="var-node.3F"><h3>node?</h3><div class="usage"><code>(node? x)</code></div><div class="doc"><div class="markdown"><p>Returns <code>true</code> iff <code>x</code> is a computation graph node.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L26">view source</a></div></div><div class="public anchor" id="var-ones"><h3>ones</h3><div class="usage"><code>(ones shape)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of <code>shape</code> filled with 1’s. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1023">view source</a></div></div><div class="public anchor" id="var-optimize"><h3>optimize</h3><div class="usage"><code>(optimize optimizer prev-optimizer-result)</code><code>(optimize optimizer prev-optimizer-result options)</code><code>(optimize optimizer graph input-map param-map state-map)</code><code>(optimize optimizer graph input-map param-map state-map options)</code></div><div class="doc"><div class="markdown"><p>Applies <code>optimizer</code> to the remaining arguments iteratively for a number of iterations determined by the value of <code>(:iterations options)</code> (defaults to 1 iteraton). Blocks the calling thread until all iterations are complete. Returns the optimizer-result of the last iteration.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2710">view source</a></div></div><div class="public anchor" id="var-optimize-async"><h3>optimize-async</h3><div class="usage"><code>(optimize-async optimizer prev-optimizer-result)</code><code>(optimize-async optimizer prev-optimizer-result options)</code><code>(optimize-async optimizer graph input-map param-map state-map)</code><code>(optimize-async optimizer graph input-map param-map state-map options)</code></div><div class="doc"><div class="markdown"><p>Applies <code>optimizer</code> to the remaining arguments iteratively for a number of iterations determined by the value of <code>(:iterations options)</code> (defaults to infinite iteratons). Launches a new thread in which optimization is performed and immediately returns a function, <code>stop</code>. Calling <code>(stop)</code> will immediately return the <code>optimizer-result</code> of the last iteration and terminate the optimization process after the next iteration is complete.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2754">view source</a></div></div><div class="public anchor" id="var-pad"><h3>pad</h3><div class="usage"><code>(pad nd padding)</code></div><div class="doc"><div class="markdown"><p>Like <code>pad-with</code> but uses 0 as the <code>fill-value</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1007">view source</a></div></div><div class="public anchor" id="var-pad-with"><h3>pad-with</h3><div class="usage"><code>(pad-with nd fill-value padding)</code></div><div class="doc"><div class="markdown"><p>Pads tensor <code>nd</code> with <code>padding</code> repetitions of <code>fill-value</code>. <code>padding</code> can be:</p>
<ul>
  <li>a scalar that is the number of elements to add on both sides of every dimension</li>
  <li>a vector of size <code>(dimensionality nd)</code>, where each element is the amount of padding to add to both sides of each dimension</li>
  <li>a matrix of size <code>[(dimensionality nd) 2]</code>, where each row is [left-padding right-padding] for that dimension</li>
</ul>
<p><code>padding</code> is non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L977">view source</a></div></div><div class="public anchor" id="var-partition-along"><h3>partition-along</h3><div class="usage"><code>(partition-along nd)</code><code>(partition-along nd axis)</code><code>(partition-along nd axis partition-size)</code><code>(partition-along nd axis partition-size step-size)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L876">view source</a></div></div><div class="public anchor" id="var-partition-along-op"><h3>partition-along-op</h3><div class="usage"><code>(partition-along-op nd axis partition-size step-size)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L860">view source</a></div></div><div class="public anchor" id="var-pow"><h3>pow</h3><div class="usage"><code>(pow a b)</code></div><div class="doc"><div class="markdown"><p>a ^ b</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L546">view source</a></div></div><div class="public anchor" id="var-random-normal"><h3>random-normal</h3><div class="usage"><code>(random-normal shape)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of <code>shape</code> filled with numbers sampled randomly from a normal distribution with mean 0 and standard deviation 1. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1033">view source</a></div></div><div class="public anchor" id="var-random-uniform"><h3>random-uniform</h3><div class="usage"><code>(random-uniform shape)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of <code>shape</code> filled numbers sampled randomly from [0, 1). Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1028">view source</a></div></div><div class="public anchor" id="var-report"><h3>report</h3><div class="usage"><code>(report &amp; operands)</code></div><div class="doc"><div class="markdown"><p>An op that accepts operands like:</p>
<p><code>(report o1 o2 o3 ... oi reporter-fn logger-fn)</code></p>
<p>where <code>o1</code>, <code>o2</code>, <code>o3</code>, … <code>oi</code> are computation graph nodes. If <code>v1</code>, <code>v2</code>, <code>v3</code>, …, <code>vi</code> are the values of nodes <code>o1</code>, <code>o2</code>, <code>o3</code>, … <code>oi</code>, then <code>(reporter-fn v1 v2 v3 ... vi)</code> must return a single object, <code>reporter-value</code>. <code>(logger-fn reporter-value)</code> is called during forward propagation, purely for side effects. The value of the <code>report</code> node itself is <code>v1</code> (i.e. it just passes through the first operand.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1237">view source</a></div></div><div class="public anchor" id="var-reset-optimizer-reporting"><h3>reset-optimizer-reporting</h3><div class="usage"><code>(reset-optimizer-reporting optimizer-result)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer-result</code> produced by an optimizer wrapped by <code>wrap-optimizer-for-reporting</code>, returns a new optimizer-result in which reporting data has been reset. Useful for ‘resetting’ reporting when optimization is restarted after being previously stopped.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2453">view source</a></div></div><div class="public anchor" id="var-reshape"><h3>reshape</h3><div class="usage"><code>(reshape nd shape)</code></div><div class="doc"><div class="markdown"><p>Changes the shape of <code>nd</code> to <code>shape</code>. Throw an Exception if the number of elements in <code>nd</code> differs from the number of elements in a tensor of <code>shape</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L832">view source</a></div></div><div class="public anchor" id="var-select-range"><h3>select-range</h3><div class="usage"><code>(select-range nd selections)</code></div><div class="doc"><div class="markdown"><p>Returns a view of a (not necessarily continuous) selection of <code>nd</code>. <code>selections</code> is a seq of objects indicating what range of the corresponding dimension should be selected. These objects can be:</p>
<ul>
  <li>a number - indicating a slice of that dimension (the dimension will be eliminated)</li>
  <li>a two-element vector like [start stop] - indicating a range of slices in [start, stop)</li>
  <li>a three-element vector like [start stop step] - indicating a range of every <code>step</code>th slice in [start, stop)</li>
  <li><code>:first</code> - indicating the first slice (the dimension will be eliminated)</li>
  <li><code>:last</code> - indicating the last slice (the dimension will be eliminated)</li>
  <li><code>:all</code> - indicating that all slices through that dimension should be kept</li>
  <li><code>:butlast</code> - indicating that all but the last slice of that dimension should be kept</li>
  <li><code>:rest</code> - indicating that all but the first slice of that dimension should be kept</li>
</ul>
<p>The size of <code>selections</code> should match the dimensionality of <code>nd</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L935">view source</a></div></div><div class="public anchor" id="var-set-rng-seed.21"><h3>set-rng-seed!</h3><div class="usage"><code>(set-rng-seed! seed-value)</code></div><div class="doc"><div class="markdown"><p>Sets the seed of the random number generator (RNG) used for random parameter initialization.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L11">view source</a></div></div><div class="public anchor" id="var-shape"><h3>shape</h3><div class="usage"><code>(shape nd)</code></div><div class="doc"><div class="markdown"><p>Returns a clojure vector of <code>nd</code>’s shape (<code>nil</code> for a scalar). Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L827">view source</a></div></div><div class="public anchor" id="var-shift"><h3>shift</h3><div class="usage"><code>(shift nd dim shift-amount)</code><code>(shift nd shifts)</code></div><div class="doc"><div class="markdown"><p>Shifts the elements in <code>nd</code> by <code>shift-amount</code> elements along single dimension <code>dim</code> or by the number of elements specified in <code>shifts</code>, a vector of shift amounts for the axes at that index. Positive shifts are up/left, and negative shifts are down/right. For instance, <code>(shift nd 1 3)</code> shifts the columns of a matrix left by three elements; and <code>(shift nd [-1, 2])</code> shifts the rows of <code>nd</code> down by 1 and the columns of nd left by 2 (the first row and last two columns will be all zeros). (<code>shifts</code>, <code>dim</code>, and <code>shift-amount</code> are non-backpropagating.)`</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L910">view source</a></div></div><div class="public anchor" id="var-simple-optimize"><h3>simple-optimize</h3><div class="usage"><code>(simple-optimize graph)</code><code>(simple-optimize graph options)</code></div><div class="doc"><div class="markdown"><p>Performs optimization of computation <code>graph</code>. <code>options</code> may include:</p>
<ul>
  <li><code>:optimizer</code> (default <code>gradient-descent-optimizer</code>) - the optimizer function to use or else a keyword for commonly used optimization strategies</li>
  <li><code>:inputs</code> (default <code>nil</code>) - map of input name to a fixed value for inputs not being optimized</li>
  <li><code>:params</code> (default all graph inputs) - map of input name to starting value for parameters to be optimized</li>
  <li><code>:state</code> (default <code>nil</code>) - map of inputs name to starting value for inputs whose values will change as  a result of running the graph but which should not be optimized</li>
  <li><code>:async</code> (default <code>false</code>) - boolean indicating if optimization should be run in a new thread</li>
  <li><code>:iterations</code> (default 1 when <code>async</code> is <code>false</code> or infinite when <code>async</code> is true) - number of  iterations to run</li>
  <li><code>:hyperparams</code> (default <code>nil</code>) - map of options that get passed onto the optimizer</li>
  <li><code>:full-result</code> (default <code>false</code>) - boolean indicating whether to return the full <code>optimizer-result</code> from the last iteration (when <code>true</code>) or just the optimized parameter map; if <code>:async</code> is <code>true</code> this applies to the return value of the returned function, rather than to the immediate return value</li>
</ul>
<p><code>:optimizer</code> can be an optimizer function or else one of the following keywords:</p>
<ul>
  <li><code>sgd</code> - stochastic gradient descent; simple gradient descent with a batch-size of 1 over all inputs (if you want to run all inputs per iteration, then leave <code>:optimizer</code> <code>nil</code>)</li>
  <li><code>:batch-gd</code> - batch gradient descent with a <code>:batch-size</code> of 192 over all inputs</li>
  <li><code>:momentum</code> - gradient descent with momentum</li>
  <li><code>:rms-prop</code> - RMSProp</li>
  <li><code>:adam</code> - the Adam algorithm (RMSProp + momentum in this implementation)</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2769">view source</a></div></div><div class="public anchor" id="var-sin"><h3>sin</h3><div class="usage"><code>(sin n)</code></div><div class="doc"><div class="markdown"><p>sin(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1187">view source</a></div></div><div class="public anchor" id="var-sinh"><h3>sinh</h3><div class="usage"><code>(sinh n)</code></div><div class="doc"><div class="markdown"><p>sinh(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1223">view source</a></div></div><div class="public anchor" id="var-size"><h3>size</h3><div class="usage"><code>(size nd)</code><code>(size nd options)</code></div><div class="doc"><div class="markdown"><p>Returns the size (as a scalar tensor) of a dimension(s) of <code>nd</code>. <code>options</code> can contain at most one key, <code>:axis</code>, that is either an integer or a seq of integers. If multiple axes are specified, the returned value is the product of their sizes. If no axis is specified, the number of elements in the array is returned.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L812">view source</a></div></div><div class="public anchor" id="var-slices"><h3>slices</h3><div class="usage"><code>(slices nd)</code><code>(slices nd axis)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L891">view source</a></div></div><div class="public anchor" id="var-slices-op"><h3>slices-op</h3><div class="usage"><code>(slices-op nd axis)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L886">view source</a></div></div><div class="public anchor" id="var-sub"><h3>sub</h3><div class="usage"><code>(sub &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Subtraction of arbitrary number of operands</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L508">view source</a></div></div><div class="public anchor" id="var-sum-along"><h3>sum-along</h3><div class="usage"><code>(sum-along nd)</code><code>(sum-along nd {:keys [axis collapse], :as options})</code></div><div class="doc"><div class="markdown"><p>Returns the sum across some dimensions of the input tensor. <code>options</code> can include:</p>
<ul>
  <li><code>:axis</code> - an integer or a vector of integers of the axes to sum across</li>
  <li><code>:collapse</code> (optional, default true) - a boolean that if <code>true</code> indicates the summed dimension should  be removed, and, if false, indicates it should be kept with a size of 1.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L698">view source</a></div></div><div class="public anchor" id="var-tan"><h3>tan</h3><div class="usage"><code>(tan n)</code></div><div class="doc"><div class="markdown"><p>tan(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1193">view source</a></div></div><div class="public anchor" id="var-tanh"><h3>tanh</h3><div class="usage"><code>(tanh n)</code></div><div class="doc"><div class="markdown"><p>tanh(n)</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1229">view source</a></div></div><div class="public anchor" id="var-tensor-and"><h3>tensor-and</h3><div class="usage"><code>(tensor-and &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise logical ‘and’ for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1068">view source</a></div></div><div class="public anchor" id="var-tensor-not"><h3>tensor-not</h3><div class="usage"><code>(tensor-not nd)</code></div><div class="doc"><div class="markdown"><p>Elementwise logical ‘not’. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1108">view source</a></div></div><div class="public anchor" id="var-tensor-or"><h3>tensor-or</h3><div class="usage"><code>(tensor-or &amp; operands)</code></div><div class="doc"><div class="markdown"><p>Elementwise logical ‘or’ for an arbitrary number of operands. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1076">view source</a></div></div><div class="public anchor" id="var-tensure-max-mask"><h3>tensure-max-mask</h3><div class="usage"><code>(tensure-max-mask nd axes)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of the same shape of <code>nd</code> where all elements that are the max along <code>axes</code> (a single axis or vector of axes) are 1 and the remaining elements are 0.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L711">view source</a></div></div><div class="public anchor" id="var-tensure-min-mask"><h3>tensure-min-mask</h3><div class="usage"><code>(tensure-min-mask nd axes)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of the same shape of <code>nd</code> where all elements that are the min along <code>axes</code> (a single axis or vector of axes) are 1 and the remaining elements are 0.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L745">view source</a></div></div><div class="public anchor" id="var-transpose"><h3>transpose</h3><div class="usage"><code>(transpose a)</code></div><div class="doc"><div class="markdown"><p>Returns the transpose of <code>a</code></p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L778">view source</a></div></div><div class="public anchor" id="var-update-iteration-data"><h3>update-iteration-data</h3><div class="usage"><code>(update-iteration-data optimizer-result k f &amp; args)</code></div><div class="doc"><div class="markdown"><p>Updates the value of key <code>k</code> in <code>optimizer-result</code>’s iteration-data to the value of <code>(apply f prev-value args)</code>.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2354">view source</a></div></div><div class="public anchor" id="var-update-node"><h3>update-node</h3><div class="usage"><code>(update-node node &amp; updates)</code></div><div class="doc"><div class="markdown"><p>Given a computation graph node and key/value pairs where the keys are node properties (keys accepted by the <code>opts</code> argument to <code>make-node</code>), returns a computation graph node with those properties updated to the provided values.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L99">view source</a></div></div><div class="public anchor" id="var-validate-optimizer-result"><h3>validate-optimizer-result</h3><div class="usage"><code>(validate-optimizer-result o)</code></div><div class="doc"><div class="markdown"><p>Returns true iff <code>o</code> is a valid optimizer result. Otherwise, throws an Exception.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2303">view source</a></div></div><div class="public anchor" id="var-wrap-optimizer-for-reporting"><h3>wrap-optimizer-for-reporting</h3><div class="usage"><code>(wrap-optimizer-for-reporting optimizer)</code></div><div class="doc"><div class="markdown"><p>Given an <code>optimizer</code>, returns a new optimizer that runs the original optimizer and optionally reports certain metrics after each iteration. In order for the returned optimizer to function correctly, the original <code>optimizer</code> must return in its <code>optimizer-result</code>’s <code>iteration-data</code> the following key/value pair:</p>
<ul>
  <li><code>:report</code> - a seq of keywords indicating what metrics to report (see below)</li>
</ul>
<p>and optionally:</p>
<ul>
  <li><code>:logger</code> - a logging function (defaults to a println logger)</li>
  <li><code>:epoch</code> - index of the current epoch for the just-completed iteration (should start at 1)</li>
  <li><code>:iteration</code> - index of the just-completed iteration (should start at 1)</li>
  <li><code>:batch-count</code> - number of batches per epoch</li>
  <li><code>:iterations</code> - total number of iterations that are expected to run</li>
</ul>
<p>The above data are required for reporting some metrics. Valid keys in <code>:report</code> are:</p>
<ul>
  <li><code>:iteration</code> - requires <code>optimizer</code> to return <code>:iteration</code></li>
  <li><code>:iteration-duration</code> - duration of the just-completed iteration</li>
  <li><code>:epoch</code> - requires <code>optimizer</code> to return <code>:epoch</code></li>
  <li><code>:epoch-duration</code> - time since the start of the current epoch</li>
  <li><code>:batch</code> - index of the current batch in the epoch (requires <code>optimizer</code> to return <code>:iteration</code> and <code>:batch-count</code>)</li>
  <li><code>:elapsed-time</code> - time since the start of optimization</li>
  <li><code>:mean-iteration-duration</code> - mean time of all iterations since the start of optimization</li>
  <li><code>:epoch-time-remaining</code> - estimated time remaining in the current epoch (requires <code>optimizer</code> to return <code>:iteration</code> and <code>:batch-count</code>)</li>
  <li><code>:time-remaining</code> - estimated time remaining to complete all iterations; (requires <code>optimizer</code> to return <code>:iterations</code>)</li>
</ul>
<p>The <code>optimizer-result</code> returned by the wrapped optimizer will include a new <code>:ranvier.core/reporter-data</code> key with data needed for reporting.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L2361">view source</a></div></div><div class="public anchor" id="var-zeros"><h3>zeros</h3><div class="usage"><code>(zeros shape)</code></div><div class="doc"><div class="markdown"><p>Returns a tensor of <code>shape</code> filled with 0’s. Non-backpropagating.</p></div></div><div class="src-link"><a href="https://github.com/cguenthner/ranvier/blob/445b63e832a6c33902afd51b5e8cbd081b745f62/src/ranvier/core.clj#L1018">view source</a></div></div></div></body></html>